# HTTP 메시지

HTTP 메시지는 HTTP 애플리케이션 간에 주고받은 데이터의 구조화된 블록이다.  

데이터의 블록들은 메시지의 내용과 의미를 설명하는 텍스트 메타 정보로 시작하고 그 다음에 선택적으로 데이터가 올 수 있다.  
<br/>
<br/>

### 메시지는 서버 방향을 인바운드로 하여 송신된다.

인바운드, 아웃바운드 : 트래픽에 네트워크간 이동하는 방향  
인바운드: 클라이언트 → 서버  
아웃바운드: 서버 → 클라이언트  
<br/>
<br/>
<br/>


## 메시지의 각 부분  
HTTP 메시지는 단순한 데이터의 구조화된 블록으로 시작줄, 헤더 블록, 본문 이렇게 세 부분으로 이루어진다.  
시작줄은 이것이 어떤 메시지인지 서술하며, 헤더 블록은 속성을, 본문은 데이터를 담고있다.(본문은 없을 수 있음)  
<br/>
<br/>
<br/>

### 메시지 문법
![Untitled](https://user-images.githubusercontent.com/95058915/232183937-ce40f687-240a-42c7-b411-afebe395b1e3.png)  

모든 HTTP 메시지는 요청 메시지나 응답 메시지로 분류된다. 요청 메시지는 웹 서버에 어떤 동작을 요구하며, 응답 메시지는 요청의 결과를 클라이언트에게 돌려준다.  
<br/>
<br/>

**요청 메시지 형식**  
<메서드> <요청 URL> <버전>  
<헤더>  
  
<엔티티 본문>  
<br/>

**응답 메시지 형식**  
<버전> <상태코드> <사유 구절>  
<헤더>  
  
<엔티티 본문>  
<br/>

**요청줄**  
요청줄은 서버에게 리소스에 대해 무언가를 해달라고 부탁한다.  
<br/>

**응답줄**  
응답 메시지는 수행 결과에 대한 상태 정보와 결과 데이터를 클라이언트에게 돌려준다.  
<br/>

**메서드**  
클라이언트 측에서 서버가 리소스에 대해 수행해주길 바라는 동작    
- GET: 서버에서 어떤 문서를 조회한다.  
- HEAD: 서버에서 어떤 문서에 대한 헤더만 가져온다.  
- POST: 서버가 처리해야 할 데이터를 보낸다.(입력 데이터를 전송)  
- PUT: 서버에 요청 메시지의 본문을 저장한다.(새 문서를 만들거나 있다면 덮어씌우는 형식)  
- DELETE: 서버에서 문서를 제거한다.  
- TRACE: 메시지가 프록시를 거쳐 서버에 도달하는 과정을 추적한다.  
- OPTIONS: 서버가 어떤 메서드를 수행할 수 있는지 확인한다.  

<br/>
<br/>


**요청URL**  
요청 대상이 되는 리소스를 지칭하는 완전한 URL 또는 URL의 경로 구성요소  
<br/>

**버전**  
이 메시지에서 사용 중인 HTTP의 버전 → HTTP/<메이저>.<마이너>  
<br/>
  
**상태 코드**  
요청 중에 무엇이 일어났는지를 설명하는 세자리 숫자  
- 1xx : 정보성 상태 코드(요청 진행 중)  
- 2xx : 응답 성공  
- 3xx : 리다이렉션(location 헤더를 통해 어디서 이동했는 지 알려줄 수 있다.)  
- 4xx : 클라이언트 에러  
- 5xx : 서버 에러  

<br/>

**사유 구절**  
숫자로 된 상태 코드의 의미를 사람이 이해할 수 있게 설명해주는 짧은 문구로, 상태 코드 이후부터 줄바꿈 문자열까지가 사유 구절이다.   
<br/>

**헤더들**  
이름, 콜론(:), 선택적인 공백, 값, CRLF가 순서대로 나타나는 0개 이상의 헤더들. 이 헤더의 목록은 빈 줄(CRLF)로 끝나 헤더 목록의 끝과 엔티티 본문의 시작을 표시한다.  
<br/>

**엔티티 본문**  
임의의 데이터 블록을 포함하며, 모든 메시지가 엔티티 본문을 갖는 것은 아니므로, 때때로 메시지는 그냥 CRLF로 끝나게 된다. 엔티티 본문이 없어도 헤더의 집합은 항상 개행(CRLF)로 끝나야 한다.  
<br/>
<br/>
<br/>

## 헤더  
HTTP 헤더 필드는 요청과 응답 메시지에 추가 정보를 더한다.  
클라이언트와 서버가 무엇을 하는지 결정하기 위해서 사용된다.  
<br/>
<br/>

### 일반 헤더   
요청과 응답 양쪽에 모두 나타날 수 있다.  
클라이언트, 서버 그리고 어딘가에 메시지를 보내는 다른 애플리케이션들을 위해 다양한 목적으로 사용된다.  

- Date: Tru, 3 Oct 1974 02:16:00 GMT  
- Connection: Keep-Alive (현재 TCP 커넥션을 유지)  

<br/>
<br/>

### 요청 헤더  
요청 메시지를 위한 헤더로, 요청에 대한 부가 정보를 제공한다.  
클라이언트고 받고자 하는 데이터 타입 등   

- User-Agent: 요청을 보낸 애플리케이션의 정보(브라우저, OS) 서버에게 말해준다.  
- Referer: 현재 표시 하는 웹페이지가 어떤 웹페이지에서 요청되었는지 알려준다.  
- Host: 요청의 대상이 되는 서버의 호스트 명과 포트를 준다.  

<br/>
<br/>


**Accept 헤더**는 클라이언트가 선호하는 능력을 알려준다.  

- Accept: 클라이언트가 선호하는 미디어 타입을 말해준다.  
- Accept-Charset: 클라이언트가 선호하는 문자집합을 말해준다.  
- Accept-Encoding: 클라이언트가 선호하는 인코딩을 말해준다.  
- Accept-Language: 클라이언트가 선호하는 언어를 말해준다.  

<br/>
<br/>

**조건부 요청 헤더**는 클라이언트가 요청에 몇몇 제약을 넣을 때 사용한다.  

- Except: 클라이언트가 요청에 필요한 서버의 행동을 열거할 수 있게 해준다.  
- Range: 서버가 범위 요청을 지원한다면, 리소스에 대한 특정 범위를 요청한다.  

<br/>
<br/>

**요청 보안 헤더**는 자체적으로 요청을 위한 간단한 인증요구/응답 체계를 갖고 있다.  

- 요청하는 클라이언트가 어느 정도 리소스에 접근하기 전에 자신을 인증하게 함으로써 트랜잭션을 약간 더 안전하게 만들고자 한다.  
- Authorization: 클라이언트가 서버에게 제공하는 인증 그 자체에 대한 정보를 담고 있다.  
- Cookie: 클라이언트가 서버에게 토큰을 전달할 때 사용한다.(진짜 보안 헤더는 아니지만, 영향을 줄 수 있음)  

<br/>
<br/>
<br/>

### 응답 헤더  

응답에 대한 부가 정보를 제공한다.(클라이언트에게 정보를 제공하기 위한 자신만의 헤더를 갖고 있다.)  

- Server: 서버 애플리케이션의 이름과 버전  
- Age: 응답이 얼마나 오래 되었는지  
- Public: 서버가 특정 리소스에 대해 지원하는 요청 메서드의 목록  

<br/>
<br/>

**협상 헤더**는  서버에 응답에 대한 여러가지 표현이 가능한 상황이라면 서버와 클라이언트가 어떤 표현을 택할 것인가에 대한 협상을 할 수 있도록 지원한다.  
- Vary: 서버가 확인해 보아야 하고 그렇기 때문에 응답에 영향을 줄 수 있는 헤더들의 목록(서버가 클라이언트에게 보내줄 리소스의 가장 적절한 버전을 선택하기 위해 살펴보아야 하는 헤더들의 목록)  

<br/>
<br/>

**응답 보안 헤더**는 HTTP 인증요구/응답 체계에서 응답 측에 해당한다.  

- Proxy-Authenticate: 프록시에서 클라이언트로 보낸 인증요구의 목록  
- Set-Cookie: 서버가 클라이언트를 인증할 수 있도록 클라이언트 측에 토큰을 설정하기 위해 사용(진짜 보안 헤더는 아니지만, 영향을 줄 수 있음)  
- WWW-Authenticate: 서버에서 클라이언트로 보낸 인증 요구의 목록  

<br/>
<br/>
<br/>


### 엔티티 헤더  
본문(body)의 크기와 컨텐츠, 혹은 리소스 그 자체를 서술한다.  
본문에 들어있는 데이터의 타입 등  
요청과 응답 양쪽 모두에 포함될 수 있다.  

- Location: 클라이언트에게 엔티티가 실제로 어디에 위치하고 있는지 말해준다. 수신자에게 새로 생성된 리소스 위치를 알려줄 때 사용한다.  

<br/>
<br/>

**컨텐츠 헤더**는 엔티티의 콘텐츠에 대한 구체적인 정보를 제공한다.(컨텐츠의 종류, 크기, 기타 컨텐츠를 처리할 때 유용하기 활용)  

- Content-Type: Body가 어떤 종류의 객체인지 말해준다.  
- Content-Encoding: 본문에 적용된 인코딩 정보  
- Content-Language: 본문을 이해하는데 가장 적절한 자연어  
- Content-Length: 본문의 길이나 크기  
- Content-Location: 리소스가 실제로 어디에 위치하는지  
- Content-Disposition: 응답 body를 브라우저가 어떻게 표시해야 할지(inline: 웹 페이지 화면에 표시, attachment: 다운로드)  
- Content-Range: 전체 리소스에서 이 엔티티가 해당하는 범위를 바이트 단위로 표현  

<br/>
<br/>

**엔티티 캐싱 헤더**는 엔티티 캐싱에 대한 정보를 제공한다.  
리소스에 대해 캐시된 사본이 아직 유효한지에 대한 정보와, 캐시된 리소스가 더 이상 유효하지 않게 되는 시점을 더 잘 추정하기 위한 단서이다.  

- Expires: 이 엔티티가 더 이상 유효하지 않아 원본을 다시 받아와야 하는 일시  
- Last-Modified: 가장 최근 이 엔티티가 변경된 일시  

<br/>
<br/>

### 확장 헤더  
명세에 정의되지 않은 새로운 헤더이다.(비표준 헤더)  
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>

### 참조
- HTTP 완벽가이드
